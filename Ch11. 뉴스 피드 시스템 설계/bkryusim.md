# Ch11. 뉴스 피드 시스템 설계

### 단일 포스트 테이블, 단일 DB, 단일 API 서버 환경에서 컨텐츠를 쓰고 읽는 동작을 수행하면 어떤 장단점이 있을까요? 

* 조회의 복잡도와 성능 문제를 해결하기 위한 설계를 제시해 주세요.
* 팬아웃을 읽기 시점에 하는 경우, 쓰기 시점에 하는 경우 각각의 장단점을 말해주세요

<details>
<summary><h4>해설</h4></summary>

> 단일 포스트 테이블, 단일 DB, 단일 API 서버 환경에서 컨텐츠를 쓰고 읽는 동작을 수행하면 어떤 장단점이 있을까요?
* SPOF
* 읽기 작업을 포스트 데이터베이스에서 하는 경우 쿼리가 복잡해지고, 데이터 모델이 복잡해 질 수 있습니다.
* 또 뉴스 피드를 로드하는 데 시간이 오래 걸릴 수 있습니다.

> 조회의 복잡도와 성능 문제를 해결하기 위한 설계를 제시해 주세요.
* 포스트 저장 서버와 팬아웃 서버를 분리하여 포스트가 저장될 때 마다 팬아웃 서버에서 사용자의 피드에 업데이트합니다.

> 팬아웃을 읽기 시점에 하는 경우, 쓰기 시점에 하는 경우 각각의 장단점을 말해주세요
* 쓰기 시점
  * 장점
    * 뉴스 피드 실시간 갱신
    * 읽기 성능 향상
  * 단점
    * 친구가 많은 사용자의 경우 갱신 시간이 느림
    * 휴면 사용자가 많은 서비스의 경우 낭비되는 컴퓨팅 자원이 늘어날 수 있음
* 읽기 시점
  * 장점
    * 핫키 문제가 없다
    * 워커 효율이 증가한다
  * 단점
    * 처음 읽는데 시간이 오래 소요될 수 있다.
</details>


<br>

### 피드 캐시의 크기를 적절히 유지하기 위한 방안을 제시해 주세요.

* 미디어 파일의 부하를 분산하고, 조회 속도를 향상시키기 위한 방안을 제시해주세요.

<details>
<summary><h4>해설</h4></summary>

> 피드 캐시의 크기를 적절히 유지하기 위한 방안을 제시해 주세요.
* 개인별 피드 개수를 특정 개수로 제한합니다.
* 너무 많은 피드가 제공되어도, 어차피 모두 조회하지 않습니다. 따라서 cache miss의 확률이 낮습니다.

> 미디어 파일의 부하를 분산하고, 조회 속도를 향상시키기 위한 방안을 제시해주세요.
* CDN을 사용하여 여러 캐시 서버에 미디어 파일을 분산하여 부하를 분산합니다.
* Cloudfront등을 사용하는 경우 지역에 알맞은 캐시 서버에 요청을 보내기 때문에 조회 속도가 향상됩니다.

</details>
