# Ch14. 유튜브 설계

### 유튜브 시스템에는 비디오 스트리밍과 업로드 기능이 필요하다. 해당 기능을 제공할 수 있는 시스템을 개략적으로 설계해보시오.

* 비디오 스트리밍시 CDN을 사용한다면 많은 비용이 발생할 수 있다. CDN 비용을 절감할 수 있는 절충안이 있는가?
* 비디오 스트리밍 프로토콜에는 무엇이 있는가?

<details>
<summary><h4>해설</h4></summary>

> 유튜브 시스템에는 비디오 스트리밍과 업로드 기능이 필요하다. 해당 기능을 제공할 수 있는 시스템을 개략적으로 설계해보시오.
* 비디오 스트리밍 시에는 빠른 응답을 위해 CDN을 사용할 수 있다. 사용자가 비디오를 재생하면 지리적으로 가까운 CDN으로부터 비디오를 전송받는다.
* 비디오 업로드 시에는 서버에 API 요청을 전송한다. API 서버는 무상태이므로 쉽게 확장이 가능하다. 따라서 사용자가 비디오 업로드 요청을 보내면, 로드밸런서가 요청을 적절한 API 서버로 분배해준다.

> 비디오 스트리밍시 CDN을 사용한다면 많은 비용이 발생할 수 있다. CDN 비용을 절감할 수 있는 절충안이 있는가?
* 시스템에 저장된 전체 비디오 중 소수 비디오만이 많은 사용자들에게 접근된다. 따라서 인기 비디오인 경우에만 CDN 캐시를 이용하고, 그 외의 비인기 비디오는 비디오 서버에서 직접 제공한다.

> 비디오 스트리밍 프로토콜에는 무엇이 있는가?
* 대표적으로 HTTP 통신 기반의 `MPEG-DASH` 프로토콜이 존재합니다. `MEGA-DASH` 방식은 하나의 비디오 파일을 여러 개의 청크로 나누고, 각각의 청크들을 다양한 품질로 인코딩합니다. 
이를 통해 비디오 품질을 자동으로 변환해가며 사용자에게 끊김 없는 비디오 재생을 보장합니다. 
</details>


<br>

### 비디오 트랜스코딩이 필요한 이유는 무엇인가?

* 비디오 전송 속도를 최적화 할 수 있는 방법에는 무엇이 있는가?
* 시스템에 여러 절차가 존재할 때, 각 절차 간 의존성이 존재하면 병렬성을 높이기 어렵다. 이에 대한 해결 방안에는 무엇이 있는가?

<details>
<summary><h4>해설</h4></summary>

> 비디오 트랜스코딩이 필요한 이유는 무엇인가?
* 상당수의 단말과 브라우저는 특정 종류의 비디오 포맷만 지원하기 때문에, 호환성 문제를 해결하기 위해 하나의 비디오를 여러 포맷으로 인코딩해두는 작업이 필요하다.
* 네트워크 대역폭에 따라 비디오 화질을 자동으로 변경하여, 사용자에게 끊김없는 비디오 재생을 보장할 수 있다.

> 비디오 전송 속도를 최적화 할 수 있는 방법에는 무엇이 있는가?
* 하나의 비디오를 여러 개의 청크로 분리한 후, 각 청크들을 병렬적으로 업로드한다.
* 네트워크 지연 시간을 줄이기 위해, 업로드 서버를 지역적으로 분산할 수 있다.

> 시스템에 여러 절차가 존재할 때, 각 절차 간 의존성이 존재하면 병렬성을 높이기 어렵다. 이에 대한 해결 방안에는 무엇이 있는가?
* 각 시스템 컴포넌트들이 느슨하게 결합되도록 만들어, 병렬성을 높일 수 있다. 
* 예를 들어, 각 시스템 컴포넌트 별로 메시지 큐를 도입한다. 모듈들은 이전 모듈의 작업이 끝날 때 까지 기다리지 않고, 큐에 보관된 작업들을 병렬적으로 처리할 수 있게 된다.
</details>
