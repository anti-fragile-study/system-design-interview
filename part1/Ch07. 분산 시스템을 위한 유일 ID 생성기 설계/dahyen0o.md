# Ch07. 분산 시스템을 위한 유일 ID 생성기 설계

### 트위터 스노플레이크로 ID를 생성할 때 ID 구조와, 이 방식의 장점을 설명하시오.

* 해당 방식을 사용할 때 고려해야 할 점은?

<details>
<summary><h4>해설</h4></summary>

> 트위터 스노플레이크로 ID를 생성할 때 ID 구조와, 이 방식의 장점을 설명하시오.

<img src="https://github.com/dahyen0o/development-books/assets/64001680/98038508-eff4-4bfc-b60a-6633b4a459ad" width="70%">

* 사인(sign) 비트: 음수와 양수를 구별하는 데 사용할 수 있다.
* 타임스탬프(timestamp): 기원 시각(epoch) 이후로 몇 밀리초가 경과했는지 나타내는 값이다.
* 데이터센터 ID: 5비트 이므로 총 2^5=32 개의 데이터센터를 지원할 수 있다.
* 서버 ID: 5비트 이므로 데이터센터당 32개의 서버를 사용할 수 잇다.
* 일련번호: 각 서버에서는 ID를 생성할 때마다 이 일련번호를 1씩 증가시킨다. 이 값은 1밀리초가 경과할 때마다 0으로 초기화 된다.

**장점**
* 규모 확장이 쉽다.
* 숫자로만 ID를 표현할 수 있다.
* 시간 순으로 ID가 증가한다.

> 해당 방식을 사용할 때 고려해야 할 점은?
* 사인 비트를 제외한 나머지 항목의 오버플로우 및 크기 (제약 사항에 따라 각 항목의 길이를 조절할 수 있다.)
* 시계 동기화 (서버들이 각각 다른 시계를 사용할 수 있다.)

</details>


<br>

### 티켓 서버로 ID를 생성할 때 단점을 얘기하시오.

* 이 단점을 보완할 방법은?

<details>
<summary><h4>해설</h4></summary>

> 티켓 서버로 ID를 생성할 때 단점을 얘기하시오.
* 티켓 서버가 하나라 SPOF 가 된다.

> 이 단점을 보완할 방법은?
* 티켓 서버를 추가하면 SPOF 문제가 해결된다.
* 하지만 동기화 문제가 발생하는데, 이를 해결하기 위해 각 티켓 서버가 ID를 다르게 생성하도록 (ex. 짝/홀수) 한다.
* 이 때 여러 티켓 서버에 최대한 균형잡히게 요청을 보내기 위해 라운드 로빈 기법을 사용한다.
* 이는 실제 Flicker가 사용하는 전략이다.

