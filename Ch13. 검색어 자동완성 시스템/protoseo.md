# Ch13. 검색어 자동완성 시스템

> 검색어 자동완성 시스템에서 검색창에 입력할 때 마다 자동완성 목록을 호출하는 API가 나가도록 설계돼서, 서버에 부담이 되는 상황이 발생했습니다. 이런 경우 어떤 방법을 통해서 부담을 줄여볼 수 있을까요?
 
* 디바운스나, 쓰로틀에 대해서 간단하게 설명해주실 수 있나요?
* 데이터베이스 샤딩을 통해서 저장소에 사용되는 서버의 개수를 늘리려고 할 때, 특정 단어로 시작하는 검색어의 양이 많다면 어떻게 샤딩을 할 수 있을까요?
* 검색어 자동완성 시스템을 구축할 때, 흔히 어뷰징이라고 하는 행위, 예를 들어 광고하고자 하는 제품을 지속적으로 검색하는 매크로를 사용하여, 해당 제품의 앞글자만 쳐도 해당 제품이 나오도록 할 때 이를 방지하는 방법이 있을까요?

<details>
<summary><h4>해설</h4></summary>

> 검색어 자동완성 시스템에서, 검색창에 입력할 때 마다 쿼리가 나가서, 서버에 부담이 되는 상황이 발생했습니다. 이런 경우 어떤 방법을 통해서 부담을 줄여볼 수 있을까요?
* 디바운스나 쓰로틀을 통해서 해당 API가 매 글자마다 나가지 않도록 해서, API수를 줄이는 방법이 있을 수 있고, 캐시계층을 중간에 두는 방법도 있을 수 있다.
* 또한 서버의 성능 혹은 서버를 늘리는 방법도 있을 수 있을 것이다.

> 디바운스나, 쓰로틀에 대해서 간단하게 설명해주실 수 있나요?
* 디바운스는 어떤 이벤트가 종료된 후 원하는 동작을 시키는 것이고, 쓰로틀은 일정 시간마다 원하는 동작을 실행시키는 것을 의미한다.
* 예를 들어, 입력창에 입력 중에는 API를 호출하지 않다가 입력이 다 완료되고 나서 API를 보내면 디바운스, 500ms 간격으로 입력창에 입력중인 단어에 대한 자동완성 목록을 호출하는 API를 보내면 쓰로틀 방법이다.

> 데이터베이스 샤딩을 통해서 저장소에 사용되는 서버의 개수를 늘리려고 할 때, 특정 단어로 시작하는 검색어의 양이 많다면 어떻게 샤딩을 할 수 있을까요?
* 데이터베이스 샤딩을 할 때, 특정 단어의 검색어 양이 많다면 해당 단어만 서버를 할당해주고, 검색어 양이 적은 단어들을 묶도록 해서 검색어 양을 평등하게 가질 수 있도록 샤딩할 수 있다.

> 검색어 자동완성 시스템을 구축할 때, 흔히 어뷰징이라고 하는 행위, 예를 들어 광고하고자 하는 제품을 지속적으로 검색하는 매크로를 사용하여, 해당 제품의 앞글자만 쳐도 해당 제품이 나오도록 할 때 이를 방지하는 방법이 있을까요?
* 사용자의 검색 이력과 행동 패턴을 분석하여 같은 단어를 계속 검색하는 비정상적인 행동을 감지하도록 하는 방법을 사용하거나, 단기간에 동일한 IP주소나 사용자로부터 발생하는 쿼리의 양을 제한하고 제한함으로써 어뷰징을 방지할 수 있다.

</details>
<br>

> 트라이 자료구조에 대해서 설명해주실 수 있나요?

* 트라이 데이터베이스로 사용할 수 있는 선택지에 대해서 설명해주실 수 있나요?
* 본인이 검색어 자동완성 시스템을 설계해야 한다면, 관계형 데이터베이스와 트라이 데이터베이스(문서 저장소, 키-값 저장소) 중 어떤 저장소를 사용할 것이고, 이에 대한 이유를 알려주세요.

<details>
<summary><h4>해설</h4></summary>

> 트라이 자료구조에 대해서 설명해주실 수 있나요?
* 트라이는 트래 형태의 자료구조로, 각 노드에 글자를 저장하고, 해당 글자 다음에 등장할 수 있는 모든 글자들의 수 만큼 자식 노드를 가질 수 있다. 
* 각 트리 노드는 하나의 단어, 또는 접두어 문자열을 나타낸다.

> 트라이 데이터베이스로 사용할 수 있는 선택지에 대해서 설명해주실 수 있나요?
* 트라이를 직렬화하여 몽고디비와 같은 문서 저장소에 저장할 수 있고, 다른 방법으로는 트라이에 보관된 모든 접두어를 해시 테이블 키로 변환하고 각 트라이 노드에 보관된 모든 데이터를 해시 테이블 값으로 변환하여 키-값 저장소를 활용할 수도 있다.

> 본인이 검색어 자동완성 시스템을 설계해야 한다면, 관계형 데이터베이스와 트라이 데이터베이스(문서 저장소, 키-값 저장소) 중 어떤 저장소를 사용할 것이고, 이에 대한 이유를 알려주세요.
* 데이터가 적은 경우에는 새로운 데이터베이스 시스템을 적용하는 것보다는 관계형 데이터베이스를 활용하는 것이 나쁘지 않을 것 같고, 저장된 데이터가 많다면 관계형 데이터베이스를 사용하면 병목이 될 수 있으므로 문서 저장소나 키-값 저장소를 활용할 수 있을 것 같다.

</details>
