# Ch05. 안정 해시 설계

> 안정 해시가 어떤 기술인지 설명해주실 수 있나요?

* 안정 해시가 기본적으로 어떻게 동작하는지 설명해주실 수 있나요?
* 안정 해시의 장점을 설명해주세요.

<details>
<summary><h4>해설</h4></summary>

> 안정 해시가 어떤 기술인지 설명해주실 수 있나요?
* 해시 테이블 크기가 조정될 때 평균적으로 오직 `k/n`개의 키만 재배치하는 해시 기술이다. 
* 여기서 k는 키의 개수이고, n은 슬롯의 개수이다. 기존의 해시 테이블은 슬롯의 수가 바뀌면 대부분의 키를 재배치한다.

> 안정 해시가 기본적으로 어떻게 동작하는지 설명해주실 수 있나요?
* 먼저 서버와 키를 균등 분포 해시 함수를 사용해 해시 링에 배치시킨다. 이후 키의 위치에서 링을 시계 방향으로 탐색하다가 만나는 최초의 서버에 키가 저장된다.

> 안정 해시의 장점을 설명해주세요.
* 서버가 추가되거나 삭제될 때 재배치되는 키의 수가 최소화된다. 데이터가 균등하게 분포하게 되므로 수평적 규모 확장성을 달성하기 쉽다.

</details>

<br>

> 안정 해시의 서버와 키를 균등 분포 해시 함수를 사용해 배치할 때, 두 가지 문제가 발생할 수 있는데 이 문제들에 대해서 설명해주세요.

* 그렇다면 이 문제를 해결하는 방법에 대해서 설명해주실 수 있나요?
* 만약 가상 노드를 통해서 해결할 수 있다면, 가상 노드는 많으면 많을수록 좋은건가요?

<details>
<summary><h4>해설</h4></summary>

> 안정 해시의 서버와 키를 균등 분포 해시 함수를 사용해 배치하는 경우, 문제가 발생할 수 있는데 어떤 문제들이 발생할 수 있는지 설명해주세요.
* 서버가 추가되거나 삭제되는 상황에서 파티션의 크기를 균등하게 유지하는 것이 불가능한 문제와 키가 하나의 서버에 몰리게 되어서 키의 균등 분포를 달성하기 어려워지는 문제가 있다.

> 그렇다면 이 문제를 해결하는 방법에 대해서 설명해주실 수 있나요?
* 실제 노드나 서버를 가리키는 노드인 가상 노드들을 생성하고, 이를 해시 링위에 배치함으로써 문제를 해결할 수 있다.

> 만약 가상 노드를 통해서 해결할 수 있다면, 가상 노드는 많으면 많을수록 좋은건가요?
* 가상 노드의 수가 많으면 많을수록 키의 분포는 점점 더 균등해진다. 하지만 가상 노드 데이터를 저장할 공간은 더 많이 필요하게 되므로, 적절하게 가상 노드의 개수를 설정하는 것이 좋다.

</details>
